<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"
	integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
	crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"
	integrity="sha512-3j3VU6WC5rPQB4Ld1jnLV7Kd5xr+cq9avvhwqzbH/taCRNURoeEpoPBK9pDyeukwSxwRPJ8fDgvYXd6SkaZ2TA=="
	crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Akshar&display=swap" rel="stylesheet">
    <title>Document</title>
    <style>
        body{
            background-color: #303030;
        }
        #container{
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        }
        .list{
            display: block;
            border: solid 10px black;
            border-radius: 10px;
            color: wheat;
        }
        .track{
            position: relative;
            margin: 5px;
            text-align: center;
            transition: transform .6s;
        }
        .track:hover{
            transform: scale(1.05);
        }
        .track:hover .cTxt{
            opacity: 1.0;
        }
        .track:hover #artwork{
            filter: brightness(30%);
        }
        .cTxt{
            display: block;
            opacity: 0;
            position: absolute;
            font-size: 30px;
            font-family: 'Akshar', sans-serif;
            top: 50%;
            left: 50%;
            color: rgb(233, 233, 233);
            transform: translate(-50%, -50%);
            transition: opacity 0.6s ease;
        }
        #artwork{
            border: solid 2px rgb(255, 255, 255);
            border-radius: 10px;
            transition: filter .6s ease;
        }
        #navbar{
            display: flex;
            width: 95%;
            margin: auto;
            margin-bottom: 30px;
            text-align: center;
            border: solid green 2px;
            border-radius: 5px;
            background-color: aliceblue;
            box-shadow: 8px 8px 1px black;
        }
        .navItem{
            margin: 5px;
            font-family: 'Akshar', sans-serif;
            color: #303030;
            transition: color 0.6s ease, transform .6s ease;
        }
        .navItem:hover{
            color:#427d53;
            transform: scale(1.05);
        }
    </style>
</head>
<body>
    <div id="navbar"></div>
    <div id="container">
    </div>
</body>
<script>
//to get the items from json folder
var array = new Array();
$.get("files.php", function(data, success){
    items = jQuery.parseJSON(data);
        jQuery.each(items, function(key, value){
        fetchMe(value);

    })
})
var i = 0;
//function to fetch all the songs from each playlist album
async function fetchMe(value){
    fetch("./jsons/" + value)
    .then(res => res.json())
    .then(data => obj = data)

    .then((html) => {
        $(document).ready(function(){
        //for each playlist object we create playlist tag
        $.each(obj, function(key,val){
            let playlist;
            let navItem;
            playlist = $('<div class="list"></div>');
            let list = value.substring(0, value.indexOf(".json"));
            navItem = $("<div class='navItem'>" + list + "</div>");
            // console.log(list);
            list = $('<h1 id="list_name" onclick=$(".track' + i + '").toggle()>' + list +'</h1>', {});
            $(playlist).append(list);
            $("#navbar").append(navItem);
            //for each tracks in single object, create its elements then add it to the playlist tag
            $.each(obj.tracks, function(key, val){
            let hrf = val.album.external_urls.spotify;
            let aName = val.album.artists[0].name;
            let tTitle = val.album.name;
            let tYear = val.album.release_date;
            // let list = value.substring(0, value.indexOf(".json"));
            let anchor = $("<a href='"+ hrf + "' target='__blank'></a>");
            let img = $("<img id='artwork' src='" + val.album.images[1].url + "'>");
            let txt = $("<div class='cTxt'>" + aName + "</br>" + tTitle + "</br>" + tYear + "</div>");
            let track = $("<div class='track"+ i + "'></div>")
            $(anchor).append(img);
            $(anchor).append(txt);
            $(track).append(anchor);
            $(playlist).append(track);
        })
		i += 1;
        //we append the playlist to the main page container
        $("#container").append(playlist);
        });

        })
    });

}


</script>
</html>
